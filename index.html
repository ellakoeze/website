<!DOCTYPE html>
<html>
  <head>
    <title>the very talented Ella Koeze</title>
    <meta charset='utf-8' />
    <link href="https://fonts.googleapis.com/css?family=Carrois+Gothic+SC|Karla" rel="stylesheet">
    <style>

      h1 {
        color: #f000000;
        font-family: 'Carrois Gothic SC', serif;
      }

      a{
        text-decoration: none;
        color: #000000;
        font-family: 'Karla', serif;
        cursor: pointer;
      }
      a:hover{
        background: #000000;
      }
      
      .grid{
        display: flex;
      }

      .project{
        background-image: url('./images/bluesquare.png'); 
        background-position: center center;
      }

    </style>
  </head>
  <body>
    <h1>ELLA KOEZE</h1>
    <div class='grid'></div>

    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script type="text/javascript">
      // Google sheets parameters
      var CLIENT_ID = '282789162693-d1qbkuo6uig9vrrocbn19beqe65fk9ep.apps.googleusercontent.com';
      var API_KEY = 'AIzaSyDvFa-dDExpUuP7Q_YPqP4yfsOiiau0nwU';
      var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];
      var SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";


      var data;


      // Function to get data from spreadsheet
      function getData() {
        gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId: '1by8a00uGvIOCmR4mFGGImdecHFagL06DMsnlaFZIGe0',
          range: 'projects!A2:F',
        }).then(function(response) {
          makeGrid(response.result.values);
        });
      }


      // On load, called to load the auth2 library and API client library.
      function handleClientLoad() {
        gapi.load('client:auth2', initClient);
      }

      

      // Initializes the API client library and calls the data request
      function initClient() {
        gapi.client.init({
          apiKey: API_KEY,
          clientId: CLIENT_ID,
          discoveryDocs: DISCOVERY_DOCS,
          scope: SCOPES
        }).then(function () {
          getData();
        });
      }

      
      function makeGrid(data){
        console.log(data);
        data.forEach(function(row) {
          var project = d3.select('.grid').append('a').append('div').attr('class','project').attr('href',row[4]);
          project.append('h3').attr('class','title').text(row[0]);
          project.append('p').attr('class','date').text(row[1]);
          project.append('p').attr('class','description').text(row[3]);
      
          if(row[5]){
            project.style('background-image', 'url("'+row[5]+'"');
          }
        });

      }





    </script>
    <script async defer src="https://apis.google.com/js/api.js"
      onload="this.onload=function(){};handleClientLoad()"
      onreadystatechange="if (this.readyState === 'complete') this.onload()">
    </script>
  </body>
</html>